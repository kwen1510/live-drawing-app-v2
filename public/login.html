<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Drawing Tool - Join Session</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="js/theme-toggle.js" defer></script>
</head>
<body class="page page--auth">
    <button id="themeToggle" class="theme-toggle" type="button" aria-label="Switch to dark mode" aria-pressed="false" data-theme="light">
        <svg class="theme-toggle__icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle class="theme-toggle__sun-core" cx="12" cy="12" r="4"></circle>
            <g class="theme-toggle__sun-rays">
                <line x1="12" y1="2" x2="12" y2="5"></line>
                <line x1="12" y1="19" x2="12" y2="22"></line>
                <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"></line>
                <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"></line>
                <line x1="2" y1="12" x2="5" y2="12"></line>
                <line x1="19" y1="12" x2="22" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"></line>
                <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"></line>
            </g>
            <path class="theme-toggle__moon" d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
    </button>
    <main class="auth-layout">
        <section class="auth-card">
            <div class="auth-card__header">
                <h1>Join a Live Drawing Session</h1>
                <p class="auth-card__lede">
                    Enter your details to jump into a collaborative whiteboard with your class.
                </p>
            </div>

            <form class="auth-form" id="loginForm">
                <label class="input-field">
                    <span class="input-label">Your name</span>
                    <input type="text" id="username" placeholder="e.g. Jordan" autocomplete="name" required>
                </label>
                <label class="input-field">
                    <span class="input-label">Session code</span>
                    <input type="text" id="sessionCode" placeholder="ABC123" autocomplete="one-time-code" required>
                </label>
                <button type="submit" class="primary-btn">Join session</button>
            </form>

            <div class="auth-meta">
                <p>
                    You'll get your own canvas and everything you draw updates instantly for the teacher.
                    Your work stays with your session code so make sure it matches exactly.
                </p>
            </div>
        </section>

        <aside class="auth-aside">
            <div class="auth-aside__card">
                <h2>Running a class?</h2>
                <p>Create a session code, monitor every student canvas and stay perfectly in sync.</p>
                <button id="openConsole" class="secondary-btn" type="button">Launch teacher console</button>
            </div>

            <div class="auth-aside__tips">
                <h3>Quick tips</h3>
                <ul>
                    <li>Scan the QR code in the teacher console to skip typing the code.</li>
                    <li>Supabase powers the realtime collaborationâ€”ensure your credentials are configured.</li>
                    <li>Works beautifully on tablets with touch gestures.</li>
                </ul>
            </div>
        </aside>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('loginForm');
            const usernameInput = document.getElementById('username');
            const sessionCodeInput = document.getElementById('sessionCode');
            const openConsoleButton = document.getElementById('openConsole');

            const urlParams = new URLSearchParams(window.location.search);
            const codeFromUrl = urlParams.get('code');

            if (codeFromUrl) {
                sessionCodeInput.value = codeFromUrl;
            }

            loginForm.addEventListener('submit', (event) => {
                event.preventDefault();

                const username = usernameInput.value.trim();
                const code = sessionCodeInput.value.trim().toUpperCase();

                if (!username || !code) {
                    alert('Please provide both your name and the session code.');
                    return;
                }

                sessionStorage.setItem('username', username);
                sessionStorage.setItem('sessionCode', code);

                window.location.href = '/student';
            });

            openConsoleButton.addEventListener('click', () => {
                window.location.href = '/console';
            });
        });
    </script>
</body>
</html>
